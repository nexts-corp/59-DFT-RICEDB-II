<script>
  vesselBehavior = {

  ready: function() {
    // console.log(1);
  },
  getDb:function (url,callback) {
    // console.log(url);
    axios.get(url)
      .then(function(response){
        callback(response.data);
      }.bind(this))
      .catch(function (error) {
      }.bind(this));
  },
  getCounty(contractId){
    this.getDb('./g2g/contract/id/'+contractId,(data)=>{

      county = data.country_id;
        // console.log(county);
        //get buyer_masks
      this.buyerMasks = data.buyer_masks;
      // get pod;
      // console.log(this.common.countryport);
      var countryport = this.common.countryport;
      // get pol
      var pol = countryport.filter(function (countryport) { return countryport.country_id == 'TH' });
       this.pol = pol;
      var pod = countryport.filter(function (countryport) { return countryport.country_id == county });
        this.pod = pod;
        // console.log(this.pod);
      // this.getDb('./common/port/country/id/'+county,(data)=>{
      //   // console.log(data);
      //   this.common.dest_port_id = data;
      //   this.common.deli_port_id = data;
      //   // console.log(this.port);dest_port_id
      // });
    });
  },
  getconfirm:function (contractId) {
    //get cl cl_id
    // this.cl_id = this.cl_id || this.$.cl_id;
    this.getDb('./g2g/confirm/contract/id/'+contractId,(data)=>{
      this.cml = data;
      // console.log(this.cml);
      // this.cl_id.items = data;
    });
  },
  getSellerPhone:function (e) {
    var selectedItem = e.detail.value;
    if (selectedItem) {
      var seller = this.common.seller.filter(function (seller) { return seller.seller_id == selectedItem });
          // console.log(seller[0].seller_phone);
          this.seller_phone=seller[0].seller_phone;
          // console.log(this.shipment.seller_phone);
    }
  },
  getShip:function (shipline_id,common) {
      this.ship_id = this.ship_id || this.$.ship_id;
      //เช็ค null or undifile
      // console.log(this.ship_id);
      // console.log(shipline_id);
      var shipline_id;
      if (typeof shipline_id === 'string'){
        shipline_id=shipline_id;
      }else {
        shipline_id=shipline_id.detail.value;
      }
      if(shipline_id){
        // console.log(shipline_id);
        // console.log(common.value.shipInShipline);
        var shipline = this.common.shipInShipline;
        var ships = shipline.filter(function (shipline) { return shipline.shipline_id == shipline_id });
       this.shipInShipline = ships[0].ship;
      //  console.log(ships[0].ship);
      }

    },
    getCmlForRiceType : function(e,id) {
    // var selectedItem = e.detail.value;
    this.type_rice_id = this.type_rice_id || this.$.type_rice_id;
    var selectedItem;
    if (typeof id === 'string'){
      selectedItem=id;
      // console.log(selectedItem+"string");
    } else {
      selectedItem=e.detail.value;
      // console.log(selectedItem+"object");
    }
     if (selectedItem) {
       console.log(this.cml);
       var cmls = this.cml.filter(function (cml) { return cml.cl_id == selectedItem });
      this.riceType = cmls[0].cl_type_rice;
       this.type_rice_id.items = cmls[0].cl_type_rice;
      //  console.log(this.type_rice_id.items);
     }
   },
   getRiceTypeForPackage : function (e,id) {
     // ต่อจาก getCmlForRiceType
     this.package_id = this.package_id || this.$.package_id;
     var selectedItem;
     if (typeof id === 'string'){
       selectedItem=id;
       // console.log(selectedItem+"string");
     }else {
       selectedItem=e.detail.value;
       // console.log(selectedItem+"object");
     }
     if (selectedItem) {
       var packages = this.riceType.filter(function (riceType) { return riceType.type_rice_id ==  selectedItem });
       this.package = packages[0].package;
       this.package_id.items = this.package;
       // console.log(this.package_id.items);
     }
   },
     getPackageForPrice:function (e,id) {
       //ถึงมาจาก _getRiceTypeForPackage
     var packageAl = this.package;
     var selectedItem;
     if (typeof id === 'string'){
       selectedItem=id;
       // console.log(selectedItem+"string");
     }else {
       selectedItem=e.detail.value;
       // console.log(selectedItem+"object");
     }
     if (selectedItem) {
       var prices = packageAl.filter(function (packageAl) { return packageAl.package_id == selectedItem });
       this.price = prices[0];
       this.quantityBag = ((parseFloat(this.price.package_kg_per_bag) * parseFloat(1000)) / parseFloat(this.price.package_weight_bag)).toFixed(3);
       this.toWords(this.quantityBag);
       this.sumGW = ((parseFloat(this.quantityBag) * (parseFloat(this.price.package_weight_bag) + (parseFloat(this.price.package_kg_per_bag) / parseFloat(1000))) / parseFloat(1000)));
       this.gw = this.sumGW.toFixed(3);
     }
    },
    toWords: function(num) {
        // Convert numbers to words
        // copyright 25th July 2006, by Stephen Chapman http://javascript.about.com
        // permission to use this Javascript on your web page is granted
        // provided that all of the code (including this copyright notice) is
        // used exactly as shown (you can change the numbering system if you wish)
        // American Numbering System
        var th = ['', 'thousand', 'million', 'billion', 'trillion'];
        // uncomment this line for English Number System
        // var th = ['','thousand','million', 'milliard','billion'];
        var dg = ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
        var tn = ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
        var tw = ['twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
        var s = num.toString();
        s = s.replace(/[\, ]/g, '');
        if (s != parseFloat(s)) return 'not a number';
        var x = s.indexOf('.');
        if (x == -1) x = s.length;
        if (x > 15) return 'too big';
        var n = s.split('');
        var str = '';
        var sk = 0;
        for (var i = 0; i < x; i++) {
            if ((x - i) % 3 == 2) {
                if (n[i] == '1') {
                    str += tn[Number(n[i + 1])] + ' ';
                    i++;
                    sk = 1;
                } else if (n[i] != 0) {
                    str += tw[n[i] - 2] + ' ';
                    sk = 1;
                }
            } else if (n[i] != 0) {
                str +=
                    dg[n[i]] + ' ';
                if ((x - i) % 3 == 0) str += 'hundred ';
                sk = 1;
            }
            if ((x - i) % 3 == 1) {
                if (sk)
                    str += th[(x - i - 1) / 3] + ' ';
                sk = 0;
            }
        }
        if (x != s.length) {
            var y = s.length;
            str +=
                'point ';
            for (var i = x + 1; i < y; i++) str += dg[n[i]] + ' ';
        }
        this.quantityWords = '(' + str.replace(/\s+/g, ' ').toUpperCase() + ' BAGS ONLY)';
        //  str.replace(/\s+/g,' ');
    },
    testNum:function(ob,param){
      //console.log(typeof ob.value);
      if(typeof ob.value == "string"){
        var pathChange = ob.path.split(".");
        if(pathChange.length == 2){
            if(pathChange[1]==param){
              ob.base[param]=parseFloat(ob.value);
              console.log(typeof ob.value);
            }
        }
      }
    },
    toInteger: function(value) {
      return parseInt(value);
    },
  };
</script>
